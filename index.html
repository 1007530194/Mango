<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Mango Editor for Markdown</title>
  <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.min.css">
  <!-- <link href="./css/markdown.css" rel="stylesheet"></link> -->
  <!-- <link href="./css/test.css" rel="stylesheet"></link> -->
	<link rel="stylesheet" type="text/css" href="./css/base.css" media="screen" />
  <!-- <link rel="stylesheet" type="text/css" href="./css/maxiang.css" media="screen" /> -->
  <link rel="stylesheet" type="text/css" href="./js/highlight/styles/monokai_sublime_with_maxiang.css" media="screen" />

  
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/monokai_sublime.min.css">
  
	<script src="./js/jquery/jquery.min.js" type="text/javascript"></script>
  <script type="text/javascript" src="./node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="./js/highlight/highlight.pack.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script>
	<script type="text/javascript" src="./js/main.js"></script>
  <script type="text/javascript" src="./js/editor.js"></script>
  <script type="text/javascript" src="./js/menu.js"></script>
	<script type="text/javascript" src="./js/taboverride/taboverride.min.js"></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        showProcessingMessages: false,
        // messageStyle: "none",
        tex2jax: { inlineMath: [['$','$'],['\\(','\\)']] },
        TeX: { equationNumbers: {autoNumber: "AMS"} }
      });
    </script>
    <script type="text/javascript" src="./node_modules/mathjax/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
	<script type="text/javascript">
		global.window = window;
		global.$ = $;
        // global.MathJax = MathJax;
		global.gui = require('nw.gui');
    hljs.initHighlightingOnLoad();
		init();
	</script>

</head>
<body>
  <div class="toolbar">
    <div class="image-background1" title=" Create a new file " style="margin-left: 5px;">
      <input type="image" src="./img/mango_new_42.png" onclick="newFile()"/>
    </div>
    <div class="image-background1" title=" Open a file " style="margin-left: 8px;">
      <input type="image" src="./img/mango_open_42.png" onclick="openFile()"/>
    </div>
    <div class="image-background1" title=" Save the current file " style="margin-left: 10px;">
      <input type="image" src="./img/mango_save_42.png" onclick="saveFile()"/>
    </div>
    <div class="image-background1" title=" Undo the last action " style="margin-left: 28px;">
      <input type="image" src="./img/mango_undo_42.png" onclick="undo()"/>
    </div>
    <div class="image-background1" title=" Redo the last undone action " style="margin-left: 10px;">
      <input type="image" src="./img/mango_redo_42.png" onclick="redo()"/>
    </div>
    <div class="image-background1" title=" Edit mode " style="margin-left: 28px;">
      <input type="image" src="./img/mango_edit_42.png" onclick="editMode()"/>
    </div>
    <div class="image-background1" title=" Preview mode " style="margin-left: 10px;">
      <input type="image" src="./img/mango_preview_42.png" onclick="previewMode()"/>
    </div>
    <div class="image-background3" title=" Export to PDF ">
      <input type="image" src="./img/mango_pdf_42.png" onclick="exportToPDF()"/>
    </div>
    <div class="image-background3" title=" Export to HTML ">
      <input type="image" src="./img/mango_html_42.png" onclick="exportToHTML()"/>
    </div>
    <!-- <button style="background: url(./img/Mango1_48.png)"  /> -->
  </div>
	<input style="display:none;" id="openFileDialog" type="file" />
	<input style="display:none;" type="file"  id="saveFileDialog" nwsaveas="file.md" />
  <input style="display:none;" type="file"  id="saveasFileDialog" nwsaveas="" />
  <input style="display:none;" type="file"  id="pdfFileDialog" nwsaveas="file.pdf" />
  <input style="display:none;" type="file"  id="htmlFileDialog" nwsaveas="file.html" />
  <div class="background">
    <textarea name="markdown" id="editor" class="md_editor"></textarea>
    <div class="md_result" id="preview">
      
    </div>
    <div id="buffer"
       style="display:none;
              position:absolute; 
              top:0; left: 0"></div>
  </div>
    

  <script type="text/javascript">
      var $divs = $('textarea#editor, div#preview');
      var sync = function(e){
          var $other = $divs.not(this).off('scroll'), other = $other.get(0);
          var percentage = this.scrollTop / (this.scrollHeight - this.offsetHeight);
          other.scrollTop = percentage * (other.scrollHeight - other.offsetHeight);
          setTimeout( function(){ $other.on('scroll', sync ); },200);
      }
      $divs.on('scroll', sync);

      // var win = global.gui.Window.get();
      // win.on('new-win-policy', function (frame, url, policy) {
      //     global.gui.Shell.openExternal(url);
      //     policy.ignore();
      // });
      $("html").on('click', 'a', function (e) {

          e.preventDefault();
          console.log("asd");
          // Open URL with default browser.
          global.gui.Shell.openExternal(e.target.href);

      });
  </script>
  <script type="text/javascript" src="./node_modules/bootbox/bootbox.min.js"></script>
  
</body>
</html>
